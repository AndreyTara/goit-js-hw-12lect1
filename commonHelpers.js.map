{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["// import axios from 'axios';\n\n// const BASE_URL = 'https://api.themoviedb.org';\n// const END_POINT = '/3/trending/movie/week';\n// const API_KEY = '9b2515cc3c50c20e84c19bb79f2b818d';\n\n// const container = document.querySelector('.js-movie-list');\n// const loadMore = document.querySelector('.js-load-more');\n\n// loadMore.addEventListener('click', onLoadMore);\n// let page = 1;\n\n// async function serviceMovie(page = 1) {\n//   const { data } = await axios(`${BASE_URL}${END_POINT}`, {\n//     // headers: {\n//     //   Authorization: `Barier ${API_KEY}`,\n//     // },\n//     params: {\n//       page: page,\n//       api_key: API_KEY,\n//     },\n//   });\n//   return data;\n// }\n\n// function createMarcup(arr) {\n//   return arr\n//     .map(\n//       ({\n//         poster_path,\n//         release_date,\n//         original_title,\n//         vote_averange,\n//         id,\n//       }) => `<li class=\"movie-card\" data-id ='${id}'>\n//       <img src=\"https://image.tmdb.org/t/p/w300${poster_path}\" alt=\"${original_title}\">\n//       <div class =\"movie-info\">\n//       <h3>${original_title}</h3>\n//             <p>Relise Date: ${release_date}</p>\n//             <p>Vote Averange: ${vote_averange}</p>\n//           </div>\n//         </li>`\n//     )\n//     .join('');\n// }\n// // poster_path ==.>>https://image.tmdb.org/t/p/w500 __https://developer.themoviedb.org/docs/image-basics\n\n// serviceMovie(page)\n//   .then(data => {\n//     console.log(data);\n//     container.insertAdjacentHTML('beforeend', createMarcup(data.results));\n//     if (data.page <= 500) {\n//       //data.total_pages\n//       loadMore.classList.remove('js-load-more-hidden');\n//     }\n//   })\n//   .catch(error => {\n//     alert(error.message);\n//   });\n\n// async function onLoadMore() {\n//   page += 1;\n//   loadMore.disabled = true;\n//   try {\n//     const data = await serviceMovie(page);\n//     container.insertAdjacentHTML('beforeend', createMarcup(data.results));\n//     if (data.page >= 500) {\n//       //data.total_pages\n//       loadMore.classList.add('js-load-more-hidden');\n//     }\n//     const listHeight = document.querySelector('.js-movie-list');\n//     const curHeight = listHeight.getBoundingClientRect().top;\n//     const card = document.querySelector('.movie-card');\n//     const cardHeight = card.getBoundingClientRect().height;\n//     console.log(curHeight);\n//     const height = -curHeight + 4 * cardHeight;\n//     console.log(height);\n//     window.scrollTo({\n//       left: 0,\n//       top: height,\n//       behavior: 'smooth',\n//     });\n//   } catch (error) {\n//     alert(error.message);\n//   } finally {\n//     loadMore.disabled = false;\n//   }\n//   console.log(page);\n// }\n\n/**\n *\n */\n\nimport axios from 'axios';\n\nconst BASE_URL = 'https://api.themoviedb.org';\nconst END_POINT = '/3/trending/movie/week';\nconst API_KEY = '9b2515cc3c50c20e84c19bb79f2b818d';\nconst container = document.querySelector('.js-movie-list');\nconst guard = document.querySelector('.js-guard');\nlet page = 1;\n\nconst options = {\n  root: null,\n  rootMargin: '0px',\n  threshold: 0,\n};\n\nconst observer = new IntersectionObserver(handlePagination, options);\n\n// observer.observe(guard);\n\nasync function serviceMovie(page) {\n  const { data } = await axios(`${BASE_URL}${END_POINT}`, {\n    params: {\n      page,\n      api_key: API_KEY,\n    },\n  });\n  return data;\n}\n\nfunction createMarcup(arr) {\n  return arr\n    .map(\n      ({\n        poster_path,\n        release_date,\n        original_title,\n        vote_averange,\n        id,\n      }) => `<li class=\"movie-card\" data-id ='${id}'>\n      <img src=\"https://image.tmdb.org/t/p/w300${poster_path}\" alt=\"${original_title}\">\n      <div class =\"movie-info\">\n      <h3>${original_title}</h3>\n            <p>Relise Date: ${release_date}</p>\n            <p>Vote Averange: ${vote_averange}</p>\n          </div>\n        </li>`\n    )\n    .join('');\n}\n\nserviceMovie(page)\n  .then(result => {\n    // console.log(result);\n    container.insertAdjacentHTML('beforeend', createMarcup(result.results));\n    if (result.page < 500) {\n      //data.total_pages\n      observer.observe(guard);\n    }\n  })\n  .catch(error => {\n    alert(error.message);\n  });\n\nfunction handlePagination(entries, observer) {\n  entries.forEach(async entry => {\n    if (entry.isIntersecting) {\n      page += 1;\n      try {\n        const data = await serviceMovie(page);\n        container.insertAdjacentHTML('beforeend', createMarcup(data.results));\n        if (data.page >= 500) {\n          observer.unobserve(entry.target);\n        }\n      } catch (error) {\n        alert(error.message);\n      }\n    }\n  });\n}\n// async function handlePagination(entries, observer) {\n//   if (entries[0].isIntersecting) {\n//     page += 1;\n//     try {\n//       const data = await serviceMovie(page);\n//       container.insertAdjacentHTML('beforeend', createMarcup(data.results));\n//       if (data.page >= 500) {\n//         observer.unobserve(entries[0].target);\n//       }\n//     } catch (error) {\n//       alert(error.message);\n//     }\n//   }\n// }\n"],"names":["BASE_URL","END_POINT","API_KEY","container","guard","page","options","observer","handlePagination","serviceMovie","data","axios","createMarcup","arr","poster_path","release_date","original_title","vote_averange","id","result","error","entries","entry"],"mappings":"svBAgGA,MAAMA,EAAW,6BACXC,EAAY,yBACZC,EAAU,mCACVC,EAAY,SAAS,cAAc,gBAAgB,EACnDC,EAAQ,SAAS,cAAc,WAAW,EAChD,IAAIC,EAAO,EAEX,MAAMC,EAAU,CACd,KAAM,KACN,WAAY,MACZ,UAAW,CACb,EAEMC,EAAW,IAAI,qBAAqBC,EAAkBF,CAAO,EAInE,eAAeG,EAAaJ,EAAM,CAChC,KAAM,CAAE,KAAAK,CAAM,EAAG,MAAMC,EAAM,GAAGX,CAAQ,GAAGC,CAAS,GAAI,CACtD,OAAQ,CACN,KAAAI,EACA,QAASH,CACV,CACL,CAAG,EACD,OAAOQ,CACT,CAEA,SAASE,EAAaC,EAAK,CACzB,OAAOA,EACJ,IACC,CAAC,CACC,YAAAC,EACA,aAAAC,EACA,eAAAC,EACA,cAAAC,EACA,GAAAC,CACR,IAAY,oCAAoCA,CAAE;AAAA,iDACDJ,CAAW,UAAUE,CAAc;AAAA;AAAA,YAExEA,CAAc;AAAA,8BACID,CAAY;AAAA,gCACVE,CAAa;AAAA;AAAA,cAGxC,EACA,KAAK,EAAE,CACZ,CAEAR,EAAaJ,CAAI,EACd,KAAKc,GAAU,CAEdhB,EAAU,mBAAmB,YAAaS,EAAaO,EAAO,OAAO,CAAC,EAClEA,EAAO,KAAO,KAEhBZ,EAAS,QAAQH,CAAK,CAE5B,CAAG,EACA,MAAMgB,GAAS,CACd,MAAMA,EAAM,OAAO,CACvB,CAAG,EAEH,SAASZ,EAAiBa,EAASd,EAAU,CAC3Cc,EAAQ,QAAQ,MAAMC,GAAS,CAC7B,GAAIA,EAAM,eAAgB,CACxBjB,GAAQ,EACR,GAAI,CACF,MAAMK,EAAO,MAAMD,EAAaJ,CAAI,EACpCF,EAAU,mBAAmB,YAAaS,EAAaF,EAAK,OAAO,CAAC,EAChEA,EAAK,MAAQ,KACfH,EAAS,UAAUe,EAAM,MAAM,CAElC,OAAQF,EAAO,CACd,MAAMA,EAAM,OAAO,CACpB,CACF,CACL,CAAG,CACH"}